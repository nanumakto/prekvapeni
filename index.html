<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <title>Překvapení</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body { margin: 0; overflow: hidden; font-family: Arial, sans-serif; background: #000; height: 100vh; }
        
        /* POZADÍ */
        .stage { 
            position: fixed; 
            inset: 0; 
            background: url('https://cafevlese.cz/wp-content/uploads/2022/05/4-1024x683.jpg') center/cover no-repeat; 
            z-index: 0; 
        }

        /* OPONA */
        .curtain-wrapper { 
            position: fixed; 
            inset: 0; 
            z-index: 100; 
            display: flex; 
            cursor: pointer; 
        }
        .curtain-left, .curtain-right {
            width: 50%; height: 100%;
            background: repeating-linear-gradient(90deg, #5a0000, #7b0000 12px, #8b0000 24px);
            transition: transform 2.6s cubic-bezier(0.45, 0.05, 0.55, 0.95);
            box-shadow: inset 0 0 50px rgba(0,0,0,0.5);
        }
        .curtain-wrapper.open .curtain-left { transform: translateX(-100%); }  
        .curtain-wrapper.open .curtain-right { transform: translateX(100%); }  
        .curtain-wrapper.open { pointer-events: none; }

        /* OBÁLKA */
        .envelope { 
            position: absolute; 
            top: -300px; 
            left: 50%; 
            transform: translateX(-50%); 
            width: 280px; 
            height: 180px; 
            display: none; 
            cursor: pointer; 
            z-index: 10; 
        }
        .envelope.show { 
            display: block; 
            animation: fall 1.5s ease-out forwards; 
        }
        @keyframes fall { 
            to { top: 65%; transform: translate(-50%, -50%); } 
        }
        
        .envelope .body { 
            position: absolute; 
            inset: 0; 
            background: #f6f1e8; 
            border-radius: 8px; 
            box-shadow: 0 10px 40px rgba(0,0,0,0.6); 
            z-index: 12; /* Před fotkou */
        } 
        .envelope .flap { 
            position: absolute; 
            top: 0; left: 0; right: 0; 
            height: 60%; 
            background: #efe6d8; 
            clip-path: polygon(0 0, 100% 0, 50% 100%); 
            transform-origin: top; 
            transition: transform 0.8s ease; 
            z-index: 13; /* Úplně vepředu */
        }
        .envelope.open .flap { transform: rotateX(180deg); } 

        /* FOTKA */
        .photo {
            position: absolute;
            left: 50%;
            top: 65%;
            width: 140px;
            height: 220px;
            transform: translate(-50%, -50%) scale(0.2);
            opacity: 0;
            z-index: 11; /* Mezi tělem obálky a pozadím */
            background: url('https://static.wixstatic.com/media/f367ba_caa1f2aefcc041249f46cab85e210eae~mv2.jpg/v1/fill/w_320,h_555,al_c,q_80,usm_0.66_1.00_0.01,enc_avif,quality_auto/WEBPOSTER.jpg') center/cover no-repeat;
            box-shadow: 0 20px 50px rgba(0,0,0,0.9);
            border: 6px solid white;
            transition: transform 2s cubic-bezier(.17,.67,.25,1), opacity 1s ease;
        }
        .photo.reveal {
            opacity: 1;
            transform: translate(-50%, -135%) scale(3.2); /* Výrazné zvětšení */
        }
    </style>
</head>
<body>

<div class="stage"></div>

<div class="curtain-wrapper" id="curtain">
    <div class="curtain-left"></div>
    <div class="curtain-right"></div>
</div>

<div class="envelope" id="envelope">
    <div class="body"></div>
    <div class="flap"></div>
</div>

<div class="photo" id="photo"></div>

<audio id="curtainSound" preload="auto">
    <source src="https://cdn.pixabay.com/audio/2022/11/25/audio_82308.mp3" type="audio/mpeg">
</audio>

<iframe id="musicFrame" style="display:none" width="0" height="0" frameborder="0" allow="autoplay"></iframe>

<script>
const curtain = document.getElementById('curtain');
const envelope = document.getElementById('envelope');
const photo = document.getElementById('photo');
const curtainSound = document.getElementById('curtainSound');
const musicFrame = document.getElementById('musicFrame');

let stage = 0;

// 1. KLIK NA OPONU
curtain.addEventListener('click', () => {
    if (stage !== 0) return;
    stage = 1;

    // Spuštění zvuku opony
    curtainSound.play().catch(error => console.log("Přehrávání zvuku selhalo:", error));
    
    curtain.classList.add('open');

    // Po doznění opony spadne obálka
    setTimeout(() => {
        envelope.classList.add('show');
    }, 2600);
});

// 2. KLIK NA OBÁLKU
envelope.addEventListener('click', () => {
    if (stage !== 1) return;
    stage = 2;

    envelope.classList.add('open');

    // Vyjetí fotky po otevření chlopně
    setTimeout(() => {
        photo.classList.add('reveal');
        
        // HUDBA ZAČNE HRÁT AŽ PO UKONČENÍ ANIMACE FOTKY
        // Animace fotky trvá 2 sekundy (viz transition: transform 2s v CSS)
        setTimeout(() => {
            musicFrame.src = "https://www.boomplay.com/embed/118150502/MUSIC?colType=5&colID=64987332&autoplay=true";
        }, 2000); 

    }, 600);
});
</script>

</body>
</html>
